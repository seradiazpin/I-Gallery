<!DOCTYPE html>
<html>
<head>
    <title>Vaporwave - A-Frame</title>
    <meta name="description" content="Vaporwave aesthetic text By Ada Rose Edwards (@lady_ada_king).">
    <script src="bower_components/aframe.min.js"></script>

    <script src="bower_components/aframe-look-at-component.min.js"></script>
    <script src="bower_components/Keypress/keypress.js"></script>
    <script src="bower_components/fetch/fetch.js"></script>
    <script src="js/global-functions.js"></script>
</head>
<body>

<a-scene>

    <a-assets>

        <a-asset-item id="mv-obj" src="galery/galeria.obj"></a-asset-item>
        <a-asset-item id="mv-mtl" src="galery/galeria.mtl"></a-asset-item>
        <!-- loby -->
        <img id="mtext" src="img/text/E-gallery2.jpg" crossorigin="anonymous"/>
        <img id="vtext" src="img/text/E-gallery3.jpg" crossorigin="anonymous"/>
        <img id="clasic_text" src="img/text/E-gallery4.jpg" crossorigin="anonymous"/>

        <!-- Principal -->
        <img id="clasic1" src="img/classic/BeFunky Collage.jpg" crossorigin="anonymous" />
        <img id="memes1"src="img/memes/angel.png" crossorigin="anonymous" />
        <img id="video1" src="img/video/tv1.png" crossorigin="anonymous" >
        <img id="sculp1" src="img/sculpture/cesar.png" crossorigin="anonymous" />

        <!--Iniccio-->
        <img id="initbridge" src="img/text/E-gallery5.jpg" crossorigin="anonymous" />
        <img id="init" src="img/text/E-gallery.jpg" crossorigin="anonymous" />

        <!-- clasic -->
        <img id="cl-t1" src="img/classic/41-min.jpg" crossorigin="anonymous" />
        <img id="cl-c1" src="img/classic/BeFunky%20Collage.jpg" crossorigin="anonymous" />
        <img id="cl-c2" src="img/classic/BeFunky%20Collage2.jpg" crossorigin="anonymous" />
        <img id="cl-c3" src="img/classic/BeFunky%20Collage3.jpg" crossorigin="anonymous" />
        <img id="cl-c4" src="img/classic/BeFunky%20Collage%20%204.jpg" crossorigin="anonymous" />
        <img id="cl-c5" src="img/classic/BeFunky%20Collage5.jpg" crossorigin="anonymous" />
        <img id="cl-c6" src="img/classic/BeFunky%20Collage%206.jpg" crossorigin="anonymous" />
        <img id="cl-c8" src="img/classic/BeFunky%20Collage%208.jpg" crossorigin="anonymous" />

        <img id="buda" src="img/sculpture/buda.png" crossorigin="anonymous" />
        <img id="busto" src="img/sculpture/busto.png" crossorigin="anonymous" />
        <img id="david" src="img/sculpture/david.png" crossorigin="anonymous" />
        <img id="fat" src="img/sculpture/fat.png" crossorigin="anonymous" />
        <img id="roma" src="img/sculpture/roma.png" crossorigin="anonymous" />
        <img id="bustino" src="img/sculpture/julio.gif" crossorigin="anonymous" />
        <img id="medu" src="img/sculpture/medu.png" crossorigin="anonymous" />
        <img id="roman" src="img/sculpture/roman-statue.png" crossorigin="anonymous" />
        <img id="sculpture" src="img/sculpture/Sculpture.png" crossorigin="anonymous" />
        <img id="zeus" src="img/sculpture/zeus.png" crossorigin="anonymous" />
        <img id="venus" src="img/sculpture/atena.png" crossorigin="anonymous" />

        <img id="leon" src="img/sculpture/leon.png" crossorigin="anonymous" />
        <img id="sireno" src="img/sculpture/sireno.png" crossorigin="anonymous" />
        <img id="vaco" src="img/sculpture/vaco.png" crossorigin="anonymous" />

        <img id="adidas"src="img/memes/angel.png"crossorigin="anonymous" />



        <img id="tv2"src="img/video/tv2.png" crossorigin="anonymous" />
        <img id="tv3"src="img/video/tv3.png" crossorigin="anonymous" />
        <img id="tv4"src="img/video/tv4.png" crossorigin="anonymous" />




        <!-- <img id="ms-half" src="assets/spherical/ms-window-half.jpg"> -->
        <img id="pink" src="https://img.gs/bbdkhfbzkk/stretch/http://i.imgur.com/1hyyIUi.jpg" crossorigin="anonymous" />
        <img src="https://img.gs/bbdkhfbzkk/stretch/https://i.imgur.com/25P1geh.png" id="grid" crossorigin="anonymous">
        <img src="https://img.gs/bbdkhfbzkk/2048x1024,stretch/http://i.imgur.com/WMNH2OF.jpg" id="chrome" crossorigin="anonymous">
        <img id="sky" src="https://img.gs/bbdkhfbzkk/2048x2048,stretch/http://i.imgur.com/WqlqEkq.jpg" crossorigin="anonymous" />


    </a-assets>

    <!-- Sky and floor -->
    <a-sky src="#sky" rotation="0 -90 0"></a-sky>

    <!-- World Elements -->
    <a-entity id="world">

        <!-- Environment model -->
        <a-entity obj-model="obj: #mv-obj; mtl: #mv-mtl" position="0 0 0"></a-entity>

    </a-entity>


    <a-entity
            geometry="primitive: plane; width: 10000; height: 10000;" rotation="-90 0 0"
            material="src: #grid; repeat: 10000 10000; transparent: true;metalness:0.6; roughness: 0.4; sphericalEnvMap: #sky;"></a-entity>

    <a-entity light="color: white; intensity: 0.8; type: ambient;" visible=""></a-entity>
    <a-entity light="color: white; intensity: 0.2" position="5 5 5"></a-entity>
    <a-entity light="color: white; intensity: 0.2" position="-5 5 15"></a-entity>
    <a-entity light="color: white; intensity: 0.8 type: ambient;"></a-entity>

    <a-entity id="text-room">
        <a-image id="txt-v" position="-14.93 10 -3" src="#vtext" scale="7 7 0" rotation="0 90 0">
        </a-image>
        <a-image id="txt-m" position="14.93 10 -3" src="#mtext" scale="7 7 0" rotation="0 -90 0">
        </a-image>
        <a-image id="txt-c" position="5 10 9.8" src="#clasic_text" scale="7 7 0" rotation="0 -180 0">
        </a-image>
    </a-entity>
    <!-- Sala central-->
    <a-entity id="es">
        <a-entity scale="2 2 2" geometry="primitive: torusKnot" position="0 6 -5" material="color: magenta; metalness:1; roughness: 0.1; sphericalEnvMap: #sky;">
            <a-animation easing="linear" attribute="rotation" dur="10000" to="0 0 360" repeat="indefinite"></a-animation>
        </a-entity>
        <a-image id="es1-s1" position="-10 5 4.9" src="#clasic1" look-at="#human-camera" scale="4 4 0">
        </a-image>
        <a-image id="es2-s1" position="8.9 4 -16" src="#memes1" look-at="#human-camera" scale="4 4 0">
        </a-image>
        <a-image id="es3-s1" position="-9.7 3.2 -15.8" src="#video1" look-at="#human-camera" scale="4 4 0">
        </a-image>
        <a-image id="es4-s1" position="9.5 4 5.5" src="#sculp1" look-at="#human-camera" scale="4 4 0">
        </a-image>
    </a-entity>
    <!-- Sala inicial -->
    <a-entity id="si">
        <a-image id="init-1" position="0 5 -48" src="#init" scale="20 20 0" >
        </a-image>
        <a-image id="init-2" position="5 10 -30" src="#initbridge" rotation="45 -90 -90" scale="15 15 0"   >
        </a-image>
    </a-entity>

    <!-- Sala clasica -->
    <a-entity id="cl">
        <!--- Galeria -->

        <a-image id="cl3-g2" position="7.5 14.17 45.93" src="#cl-c2" scale="15 15 0" rotation=" -10 0 0">
        </a-image>
        <a-image id="cl2-g4" position="-7.5 14.178 45.93" src="#cl-c4" scale="15 15 0" rotation=" -10 0 0">
        </a-image>

        <a-image id="cl3-g8" position="-14.25 10 39.90" src="#cl-c8" scale="10 10 0" rotation=" 10 90 0">
        </a-image>
        <a-image id="cl2-g6" position="-14.25 10 29.90" src="#cl-c6" scale="10 10 0" rotation=" 10 90 0">
        </a-image>

        <a-image id="cl3-g5" position="14.25 10 39.90" src="#cl-c5" scale="10 10 0" rotation=" 10 -90 0">
        </a-image>
        <a-image id="cl2-g3" position="14.25 10 29.90" src="#cl-c3" scale="10 10 0" rotation=" 10 -90 0">
        </a-image>


        <!-- zona derecha -->
        <a-image id="cl1-s2" position="11.8 3.5 24.28" src="#buda" look-at="#human-camera"  scale="3 3 0">
        </a-image>
        <a-image id="cl3-s2" position="11.8 3.5 32.05" src="#sculp1" look-at="#human-camera"  scale="3 3 0" >
        </a-image>
        <a-image id="cl2-s2" position="11.8 4 28" src="#david" look-at="#human-camera" scale="3 4 0">
        </a-image>

        <a-image id="cl1-s1" position="7.82 3.5 24.28" src="#busto" look-at="#human-camera" scale="2 2 0">
        </a-image>
        <a-image id="cl3-s1" position="7.82 3.5 32.05"src="#medu" look-at="#human-camera" scale="2 2 0">
        </a-image>
        <a-image id="cl2-s1" position="7.82 3.5 28" src="#roman" look-at="#human-camera" scale="2 2 0">
        </a-image>

        <!--  zona izquierda -->
        <a-image id="cl1-s3" position="-12 4 24.28" src="#sculpture" look-at="#human-camera" scale="3 4 0">
        </a-image>
        <a-image id="cl3-s3" position="-12 4 32.05"src="#zeus" look-at="#human-camera" scale="3 4 0">
        </a-image>
        <a-image id="cl2-s3" position="-12 4 28" src="#venus" look-at="#human-camera" scale="3 4 0">
        </a-image>

        <a-image id="cl1-s4" position="-7.82 3.5 24.28" src="#roma" look-at="#human-camera" scale="2 2 0">
        </a-image>
        <a-image id="cl3-s4" position="-7.82 3.5 32.05"src="#bustino" look-at="#human-camera" scale="2 2 0">
        </a-image>
        <a-image id="cl2-s4" position="-7.82 3.5 28" src="#fat" look-at="#human-camera" scale="2 2 0">
        </a-image>

        <!-- centro -->
        <a-image id="cl1-c5" position="4.6 4 41.37" src="#vaco" scale="4 4 0">
        </a-image>
        <a-image id="cl1-c6" position="-4.6 4 41.37" src="#vaco" scale="4 4 0" rotation="0 180 0">
        </a-image>
        <a-image id="cl1-c3" position="4.6 4 39.04" src="#sireno" scale="4 4 0">
        </a-image>
        <a-image id="cl1-c4" position="-4.6 4 39.04" src="#sireno" scale="4 4 0" rotation="0 180 0">
        </a-image>

        <a-image id="cl1-c7" position="0 5 40" src="#zeus" scale="6 6 0">
        </a-image>
        <a-image id="cl1-c8" position="-1.05 3.5 38.82" src="#venus" scale="3 3 0">
        </a-image>
        <a-image id="cl1-c9" position="1.05 3.5 38.82" src="#sculp1" scale="3 3 0" rotation="0 180 0">
        </a-image>
        <a-image id="cl1-c10" position="0 3 36.35" src="#sculpture" scale="2 2 0">
        </a-image>

        <a-image id="cl1-c1" position="4.6 3.5 36.35" src="#leon" scale="3 3 0">
        </a-image>
        <a-image id="cl1-c2" position="-4.6 3.5 36.35" src="#leon" scale="3 3 0" rotation="0 180 0">
        </a-image>

        <a-image id="i2-tec2" position="0 22 33.9" src="#cl-t1"  rotation="270 0 0" scale="30 30 0"></a-image>


    </a-entity>
    <!-- Sala video

    <a-video src="#pants" width="16" height="9" position="0 1 -30"></a-video>
    -->

    <!-- Human Camera, put down here for a reason, but I can't remember why -->
    <a-camera id="human-camera" position="-37.05 1 -15.9" wasd-controls active="true" fov="70" rotation="0 180 0">
        <a-entity cursor="fuse: true; maxDistance: 50; timeout: 500" position="0 0 -2" geometry="primitive: plane; height: .05; width: .05"  material="color: #fff"></a-entity>
    </a-camera>

</a-scene>



<script>


    /*
     Fetch the settings every 1.5sec
     */
    var settings = null;

    // Fetches the settings JSON object
    fetchSettings();

    function fetchSettings(){
        fetch('assets/11/11-settings.json').then(function(response){
            response.json().then(function(responseData){
                settings = responseData;
            });
        });
    }

    // Creates the interval based settings check
    var intervalID = window.setInterval(checkSettingsCallback, 1500);


    /*
     Setup global variables
     */
    var scene = document.querySelector('a-scene');
    var world = document.querySelector('#world');
    var camera = document.querySelector('a-camera');
    var cameraLastPosition = camera.getAttribute('position');


    /*
     Add event listener to run after scene is loaded
     */
    scene.addEventListener('loaded', function(){

        // Pull in the dev tools from global.js
        devTools();

        // Situate the camera based on given position
        setCamera(camera, settings.cameraPosition);

        // Place all of the transition orbs around the sce
        placeTransitionOrbs([
            {x: 0,        y: 1,     z: -18.5},
            {x: -11.5,    y: 1,     z: -8.96},
            {x: 0,        y: 1,     z: 6},
            {x: 12.5,     y: 1,       z: -8.96},
            {x: 0,        y: 1,       z: -31.1},
            {x: 0,        y: 1,       z: -45.7},
            {x: -22,      y: 1,       z: -9.3},
            {x: -39.9,    y: 1,       z: -9.3},
            {x: 22.4,     y: 1,       z: -9.3},
            {x: 35.75,    y: 1,    z: -9.3},
            {x: 38.75,    y: 1,    z: 1.9},
            {x: 38.7,     y: 1,    z: -14.48},
            {x: -42.86,   y: 1,    z: 1.56},
            {x: -42.8,    y: 1,    z: -15.8},
            {x: 0,        y: 1,    z: 15.32},
            {x: 0,        y: 1,    z: 28.95},
            {x: 0,        y: 50,    z: 0}
        ], true);

        // Create the spherical image orbs array
        var sphericalImageTargetOrbPositions = [
            {x: 7.2, y: -100, z: 14},
            {x: 2.6, y: -100, z: 14}
        ];

        // And place them around the scene
        placeTransitionOrbs(sphericalImageTargetOrbPositions, true, 'sphericalImageTarget')

        // Find all targets
        var targets = scene.querySelectorAll('.target');

        // And for each of them, add the 'click' event listener. It fires when the user gazes at the orb
        forEach(targets, function(el){
            el.addEventListener('click', function () {
                console.log('I was clicked!');
                setActiveTransition(el);
            });
        });

        // Do the same for the spherical images too
        var sphericalImageTarget = scene.querySelectorAll('.sphericalImageTarget');
        var msSpheres = scene.querySelectorAll('.ms-spherical');
        var msSpheresExit = scene.querySelectorAll('.ms-exit'); //TODO put on door

        sphericalImageTarget[0].addEventListener('click', function () {
            setActiveTransition(sphericalImageTarget[0], msSpheres[0].parentNode.getAttribute('position'));
        });
        sphericalImageTarget[1].addEventListener('click', function () {
            setActiveTransition(sphericalImageTarget[1], msSpheres[1].parentNode.getAttribute('position'));
        });

        forEach(msSpheresExit, function(el){
            el.addEventListener('click', function () {
                setActiveTransition(el, '0 ' + settings.height + ' 0');
            });
        });

    });

    /*
     Keylistener functions
     */
    // Create new listener
    var keyListener = new window.keypress.Listener();

    // And tie them to keys
    keyListener.simple_combo('1', function(){
        // By turning off the .fetch variable, the browser stops looking
        // to the /assets/11/11-settings.json file. That's nice because
        // we can instead feed it our new selection without having it be
        // replaced in 1.5 seconds.
        settings.fetch = false;
        settings.transition = "Jump"
        console.log("Fetch turned off.");
        console.log("Transition set to: ", settings.transition);
    });
    keyListener.simple_combo('2', function(){
        settings.fetch = false;
        settings.transition = "Fade Jump"
        console.log("Fetch turned off.");
        console.log("Transition set to: ", settings.transition);
    });
    keyListener.simple_combo('3', function(){
        settings.fetch = false;
        settings.transition = "Micro-Movements"
        console.log("Fetch turned off.");
        console.log("Transition set to: ", settings.transition);
    });
    keyListener.simple_combo('4', function(){
        settings.fetch = false;
        settings.transition = "Animate"
        console.log("Fetch turned off.");
        console.log("Transition set to: ", settings.transition);
    });
    keyListener.simple_combo('-', function(){
        var transition = settings.transition;
        // Since an incoming variable may include 'Short' or 'Long', we
        // just cut it right on out of there. No errors to see here.
        var newStr1 = transition.replace(/Short/, ' ');
        var newStr2 = newStr1.replace(/Long/, ' ');
        var newStr3 = newStr2.trim();
        settings.transition = newStr3 + " Short";
        console.log("Transition set to: ", settings.transition);
    });
    keyListener.simple_combo('=', function(){
        var transition = settings.transition;
        var newStr1 = transition.replace(/Short/, ' ');
        var newStr2 = newStr1.replace(/Long/, ' ');
        var newStr3 = newStr2.trim();
        settings.transition = newStr3 + " Long";
        console.log("Transition set to: ", settings.transition);
    });
    // Useful for setting up orbs
    keyListener.simple_combo('c', function(){
        console.log(camera.getAttribute('position'));
    });


    /*
     Create the composable transistions
     */

    // Jump: instantaneous change in position
    function transitionJump(position){
        camera.setAttribute('position', position);
    }

    // Fade: useless by itself as a transition, but integral to the fade +
    // jump transition. It also creates the sphere that goes over the
    // camera. Accepts a duration, easing function, and allows you to pass
    // a middle function to act in the middle of the transition.
    function transitionFade(duration, easing, middleFunction){
        // Adds a sphere around the camera
        addEl(camera, {
            entityType: 'sphere',
            id: 'fadeSphere',
            radius: .5,
            color: '#000',
            position: '0 0 0',
            side: 'double',
            opacity: '0',
            class: 'remove',
        });

        // Creates an empty middleFunction if one isn't defined
        if(middleFunction == undefined){
            middleFunction = function(){};
        }
        // Add the opacity animation to the sphere, making it seem like the
        // world goes dark and then comes back up.
        addAnimation(camera.querySelector('#fadeSphere'), {
            attribute: "opacity",
            begin: 0,
            dur: duration,
            direction: "alternate",
            easing: "ease-in-out-" + easing,
            fill: "forwards",
            from: 0,
            to: 1,
            repeat: 1,
            class: 'remove'
        }, function(){
            // And pass the middle function down.
            middleFunction();
        });
    }

    // Fade (fade + jump): fade to black, jump, then unfade.
    function transitionFadeJump(duration, easing, position){
        // Use the fade transition, passing variables down, and include the
        // jump transition as the middle function
        transitionFade(duration, easing, function(){
            transitionJump(position);
        });
    }

    // Micro-movements: creates a stepped motion between the current
    // position and the final position.
    function transitionMicromovements(position, stepCount, duration){
        // Get the current position and the final position
        var oldPos = camera.getAttribute('position');
        var newPos = position;

        // Create a steps object, a linear distance calculation for a single
        // step for each dimensional component
        var steps = {
            x: (newPos.x - oldPos.x) / stepCount,
            y: (newPos.y - oldPos.y) / stepCount,
            z: (newPos.z - oldPos.z) / stepCount
        }

        // Calculate the time to pause on each step
        var stepDuration = duration / stepCount;

        // I don't really know how callbacks work, but I stumbled long enough
        // to make this work. This moves the camera one step towards the
        // final position.
        function callback(){
            return function(){
                oldPos = camera.getAttribute('position');
                newPosition = {
                    x: oldPos.x + steps.x,
                    y: oldPos.y + steps.y,
                    z: oldPos.z + steps.z
                };
                camera.setAttribute('position', newPosition);
            }
        }

        // Loops the single step action however many times stepCount dictates
        for(i = 0; i < stepCount; i++){
            setTimeout(callback(), stepDuration * (i+1));
        }

    }

    // Animate: smooth animation between the current position and final
    // position, derived from a speed variable. Speed is in seconds.
    function transitionAnimate(position, speed){
        // Get the current and final positions
        var oldPos = camera.getAttribute('position');
        var newPos = position;

        // Calculate linear distance per component and total
        function calcLinearDistance(objA, objB){
            var x = objA.x - objB.x;
            var y = objA.y - objB.y;
            var z = objA.z - objB.z;
            var dist = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2) + Math.pow(z, 2));
            return {x, y, z, dist};
        }

        var distance = calcLinearDistance(newPos, oldPos);

        // Physics reminder time!
        // v = x / t
        // thus, t = x / v
        var duration = (distance.dist / speed) * 1000;

        // Add the camera animation
        addAnimation(camera, {
            attribute: 'position',
            dur: duration,
            easing: 'linear',
            to: newPos.x + ' ' + newPos.y + ' ' + newPos.z
        }, true);
    }

    // Didn't get this far...
    function transitionRotate(){

    }

    // Adds an animation to an element based on given parameters
    function addAnimation(insertEl, animationParameters, removeBool, middleFunction){
        // Model:
        // var animationParameters = {
        //    attribute: "opacity",
        //    begin: 2000,
        //    dur: 1000,
        //    direction: "alternate",
        //    easing: "ease-in-out-sine",
        //    fill: "forwards",
        //    from: 0,
        //    to: 1,
        //    repeat: 1
        // }

        // Create a new animation element
        var newEl = document.createElement('a-animation');

        // Set the attributes of the element if they were passed in the
        // animationParameters{}
        if(animationParameters.attribute != undefined)
            newEl.setAttribute('attribute', animationParameters.attribute);

        if(animationParameters.begin != undefined)
            newEl.setAttribute('begin', animationParameters.begin);

        if(animationParameters.dur != undefined)
            newEl.setAttribute('dur', animationParameters.dur);

        if(animationParameters.direction != undefined)
            newEl.setAttribute('direction', animationParameters.direction);

        if(animationParameters.easing != undefined)
            newEl.setAttribute('easing', animationParameters.easing);

        if(animationParameters.fill != undefined)
            newEl.setAttribute('fill', animationParameters.fill);

        if(animationParameters.from != undefined)
            newEl.setAttribute('from', animationParameters.from);

        if(animationParameters.to != undefined)
            newEl.setAttribute('to', animationParameters.to);

        if(animationParameters.repeat != undefined)
            newEl.setAttribute('repeat', animationParameters.repeat);

        if(animationParameters.class != undefined)
            newEl.setAttribute('class', animationParameters.class);

        if(animationParameters.id != undefined)
            newEl.setAttribute('id', animationParameters.id);

        // Add the element to the DOM
        insertEl.appendChild(newEl);

        // If there isn't a removeBool, but there is a middleFunction(), set
        // the vars as such
        if(typeof removeBool == 'function'){
            middleFunction = removeBool;
            removeBool = undefined;
        }else if(removeBool == true){
            var classes = newEl.getAttribute('class');
            if(classes == null){
                newEl.setAttribute('class', 'remove');
            }else{
                classes += ' remove';
                newEl.setAttribute('class', classes);
            }
        }

        // If the remove boolean is set to true (or default is to remove),
        // then remove the animation element after the animation runs
        if(removeBool == undefined || removeBool == true){

            newEl.addEventListener('animationend', function() {
                var parentNode = this.parentNode;
                var removeNode = parentNode.querySelector('.remove');
                parentNode.removeChild(removeNode);
                console.log('Animation removed with attribute: ' + animationParameters.attribute);

                if(parentNode.getAttribute('class') == 'remove'){
                    removeNode = parentNode.parentNode.querySelector('.remove');
                    parentNode.parentNode.removeChild(removeNode);
                }
            });

        }

        // If the middleFunction is defined, then start it with the animation
        // Should probably have a wait timer (TODO)
        if(middleFunction != undefined){

            // To get rid of running on each repeat
            middleFunctionRun = false;

            // When the animation starts, wait half of the duration of the
            // animationParameters.dur to start the middle function.
            newEl.addEventListener('animationstart', function() {
                if(middleFunctionRun == false){
                    setTimeout(function(){
                        middleFunction();
                    }, animationParameters.dur / 2);
                    middleFunctionRun = true;
                }
            });
        }
    }

    // Create an element inside of a given element based on parameters
    function addEl(insertEl, elParameters){
        // Model follows a-entitiy attributes

        // Create a new entity element
        var newEl = document.createElement('a-' + elParameters.entityType);

        // Set the attributes of the element if they were passed in the
        // elParameters{}
        if(elParameters.id != undefined)
            newEl.setAttribute('id', elParameters.id);

        if(elParameters.class != undefined)
            newEl.setAttribute('class', elParameters.class);

        if(elParameters.radius != undefined)
            newEl.setAttribute('radius', elParameters.radius);

        if(elParameters.color != undefined)
            newEl.setAttribute('color', elParameters.color);

        if(elParameters.position != undefined)
            newEl.setAttribute('position', elParameters.position);

        if(elParameters.side != undefined)
            newEl.setAttribute('side', elParameters.side);

        if(elParameters.opacity != undefined)
            newEl.setAttribute('opacity', elParameters.opacity);

        // Add the element to the DOM
        insertEl.appendChild(newEl);

    }

    // Places transition orbs around the world based on a given array. Adds
    // the height of the user by default (pass 'false' to not add height).
    function placeTransitionOrbs(orbPositions, addHeight, addClass){
        // Loop through all given orb positions
        for(i = 0; i < orbPositions.length; i++){

            if(addHeight == true || addHeight == undefined){
                orbPositions[i].y += settings.height;
            }

            if(addClass == undefined){
                addClass = 'target';
            }

            // Add sphere to world
            addEl(world, {
                entityType: 'sphere',
                radius: .7,
                color: '#bc0d11',
                opacity: .7,
                position: orbPositions[i],
                class: addClass
            })
        };
    }

    // Controller for the active transition
    function setActiveTransition(el, givenPosition){
        // If the given position isn't defined, then get the position of the
        // given element
        if(givenPosition == undefined)
            newPos = el.getAttribute('position');
        else
            newPos = givenPosition;

        // Set the transition based on the settings object
        switch(settings.transition){
            case 'Jump':
                transitionJump(newPos);
                break;
            case 'Fade Jump':
                transitionFadeJump(400, 'sine', newPos);
                break;
            case 'Fade Jump Short':
                transitionFadeJump(200, 'sine', newPos);
                break;
            case 'Fade Jump Long':
                transitionFadeJump(1000, 'sine', newPos);
                break;
            case 'Micro-Movements':
                transitionMicromovements(newPos, 5, 800);
                break;
            case 'Micro-Movements Short':
                transitionMicromovements(newPos, 10, 800);
                break;
            case 'Micro-Movements Long':
                transitionMicromovements(newPos, 3, 800);
                break;
            case 'Animate':
                transitionAnimate(newPos, 10);
                break;
            case 'Animate Short':
                transitionAnimate(newPos, 100);
                break;
            case 'Animate Long':
                transitionAnimate(newPos, 1);
                break;
            default:
                break;
        }
    }

</script>
</body>
</html>